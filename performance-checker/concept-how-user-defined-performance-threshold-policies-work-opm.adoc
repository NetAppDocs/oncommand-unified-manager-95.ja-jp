---
permalink: performance-checker/concept-how-user-defined-performance-threshold-policies-work-opm.html 
sidebar: sidebar 
keywords:  
summary: ストレージオブジェクト（アグリゲートやボリュームなど）にパフォーマンスしきい値ポリシーを設定して、クラスタでパフォーマンス問題 が発生していることを通知するイベントをストレージ管理者に送信できるようにします。 
---
= ユーザ定義のパフォーマンスしきい値ポリシーの仕組み
:allow-uri-read: 
:icons: font
:imagesdir: ../media/


[role="lead"]
ストレージオブジェクト（アグリゲートやボリュームなど）に対してパフォーマンスしきい値ポリシーを設定して、クラスタでパフォーマンス問題が発生していることを通知するイベントをストレージ管理者に送信できるようにします。

ストレージオブジェクトのパフォーマンスしきい値ポリシーを作成する手順は次のとおりです。

* ストレージオブジェクトを選択する
* オブジェクトに関連付けられているパフォーマンスカウンタを選択しています
* 警告および重大な状況とみなされるパフォーマンスカウンタの上限値を指定します
* カウンタが上限値を超える必要がある期間を指定します


たとえば、ボリュームの IOPS が 10 分間連続して 1 秒あたり 750 件の処理数を超えるたびに重大イベントの通知を受け取るように、ボリュームに対してパフォーマンスしきい値ポリシーを設定できます。同じしきい値ポリシーで、 IOPS が 10 分間にわたって 1 秒あたり 500 件の処理数を超えたときに警告イベントを送信するように指定することもできます。

[NOTE]
====
現在のリリースでは、カウンタの値が設定値を超えたときにイベントを送信するしきい値を設定できます。カウンタの値が設定値を下回ったときにイベントを送信するしきい値は設定できません。

====
次のカウンタグラフの例では、 1 ： 00 に警告のしきい値（黄色のアイコン）に違反し、 12 ： 10 、 12 ： 30 、 1 ： 10 に重大のしきい値（赤のアイコン）に違反していることがわかります。

image::../media/opm2-threshold-breach.gif[opm2 のしきい値違反です]

しきい値の違反は、指定した期間、継続的に発生する必要があります。何らかの理由でしきい値を下回った場合は、以降の違反が新しい期間の開始とみなされます。

一部のクラスタオブジェクトとパフォーマンスカウンタでは、 2 つのパフォーマンスカウンタが上限を超えた場合にイベントが生成されるしきい値ポリシーを作成できます。たとえば、次の条件を使用してしきい値ポリシーを作成できます。

|===
| クラスタオブジェクト | パフォーマンスカウンタ | 警告しきい値 | 重大のしきい値 | 期間 


 a| 
ボリューム
 a| 
レイテンシ
 a| 
10 ミリ秒
 a| 
20 ミリ秒
 a| 
15 分

|===
2 つのクラスタオブジェクトを使用するしきい値ポリシー原因両方の条件に違反した場合にのみイベントが生成されます。たとえば、次の表に定義されているしきい値ポリシーを使用します。

|===
| ボリュームレイテンシの平均 | アグリゲートのディスク利用率 | 作業 


 a| 
15 ミリ秒
 a| 
50%
 a| 
イベントは報告されません。



 a| 
15 ミリ秒
 a| 
75%
 a| 
警告イベントが報告されます。



 a| 
25 ミリ秒
 a| 
75%
 a| 
警告イベントが報告されます。



 a| 
25 ミリ秒
 a| 
90%
 a| 
重大イベントが報告されます。

|===